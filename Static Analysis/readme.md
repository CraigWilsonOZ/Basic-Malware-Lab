## Static Analysis Process

Static Analysis is reviewing the executable without running the code. We
use tools to inspect areas of the executable in the hope to identify
possible actions it will take on the environment.

The sample file is a fake Excel Document:

![Graphical user interface, text, application, email Description
automatically
generated](./media/image1.png){width="1.8901017060367453in"
height="2.7278772965879265in"}

### **Stage 1:** File information. 

This section attempts to determine what the file is and how it will be
executed. Confirm the file information using TrID.

![Graphical user interface, text, application, email Description
automatically
generated](./media/image2.png){width="3.9117279090113737in"
height="2.920022965879265in"}

Results show a compressed file and the time to try to extract it.
Switching to the tool: Exeinfo PE. This tool can review the file and
tell us how to extract it.

![Graphical user interface, text, application Description automatically
generated](./media/image3.png){width="4.259799868766404in"
height="2.1012828083989503in"}

Extracting the file with UPX.EXE

![A screenshot of a computer Description automatically generated with
medium confidence](./media/image4.png){width="5.501567147856518in"
height="1.267810586176728in"}

Now back in TrID, we can see the accurate information:

![Graphical user interface, text, application, email Description
automatically
generated](./media/image5.png){width="3.6116885389326336in"
height="2.7141513560804897in"}

### **Stage 2:** View the information from the executable. 

Here we attempt to find out how the file executes, libraries,
integration points and other information---by opening the tool in
PEStudio.

![Graphical user interface, text, application, email Description
automatically generated](./media/image6.png){width="4.755641951006124in"
height="1.9083683289588802in"}

Here we can see the file has something in it. It\'s been created in
Russia, has two functions, and is flagged in VirusTotal.

![Graphical user interface, text, application Description automatically
generated](./media/image7.png){width="4.809802055993001in"
height="1.3929560367454068in"}

VirusTotal shows a massive number of triggers:

![A screenshot of a computer Description automatically generated with
medium confidence](./media/image8.png){width="4.391453412073491in"
height="2.5800885826771656in"}

Functions are showing some network connections:

![Graphical user interface, text, application Description automatically
generated](./media/image9.png){width="4.804501312335958in"
height="2.1504735345581802in"}

### **Stage 3:** Dumping the string. 

In this stage, we dump all the strings out of the files. We are looking
for known locations or commands in the file. Strings can be found in two
ways; the first is via PEStudio:

PEStudio is reporting over 2000 strings. Looking at this, they appear to
be obfuscated.

![Graphical user interface, application, table Description automatically
generated with medium
confidence](./media/image10.png){width="5.020732720909886in"
height="2.9642672790901137in"}

The other method uses BinText. Open the BinText Tool. This tool exports
the string from the file as well.

![Graphical user interface, text, application, email Description
automatically
generated](./media/image11.png){width="5.0772747156605424in"
height="3.5039162292213475in"}

Interesting points in the string dump show download location.

![Graphical user interface, text, application, email Description
automatically
generated](./media/image12.png){width="5.0959153543307085in"
height="1.2838593613298337in"}

We can also see some HTML.

![Graphical user interface, text, application, email Description
automatically
generated](./media/image13.png){width="5.041085958005249in"
height="2.622749343832021in"}

Here we can see it will load some values in the run registry key to keep
control of the system.

![](./media/image14.png){width="5.809607392825897in"
height="0.4685793963254593in"}

The file is Malware. It\'s downloading from a site. The next step is to
work out what it\'s downloading.

The last check is for encrypted strings with HTTP: This will use the
tool xorsearch

![Text Description automatically
generated](./media/image15.png){width="5.8416590113735785in"
height="1.128076334208224in"}

Found only the known HTTP address, no encrypted details.

### **Stage 4:** Identify the Hash. 

All files can have a hash created; here, we dump the hash and check it
with VirusTotal and other sites. This should provide some information on
known Malware. If the hash is known, then we can follow the existing
Analysis.

To work out the hash open the tool HashCalc.

Compress File Hash:

![Graphical user interface, table Description automatically generated
with medium
confidence](./media/image16.png){width="1.8910192475940508in"
height="2.579099956255468in"}

Uncompressed Hash:

![Graphical user interface, application Description automatically
generated with medium
confidence](./media/image17.png){width="1.8758530183727034in"
height="2.5636646981627296in"}

Using the Hash on VirusTotal, search find the existing Malware.

![Graphical user interface, application Description automatically
generated](./media/image18.png){width="4.243106955380577in"
height="2.433228346456693in"}
