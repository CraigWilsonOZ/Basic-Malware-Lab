## Dynamic Analysis Process

Dynamic Analysis is reviewing the executable while it is running the
code.

### Stage 1: Switch the Virtual Machine to an isolated network

In Hyper-V, switch the Virtual Machine to an internal-only network.

![Graphical user interface, text, application, email Description
automatically generated](./media/image1.png){width="3.463570647419073in"
height="3.309309930008749in"}

Create an export or snapshot of the VM to allow rollback, Right-click on
the VM and select Checkpoint.

![A picture containing graphical user interface Description
automatically generated](./media/image2.png){width="5.11491469816273in"
height="0.8375634295713036in"}

### Stage 2: Running the tools

On the VM, run the tool ProcMon, disable the capture and clear it.

![Graphical user interface, text, application Description automatically
generated](./media/image3.png){width="3.740242782152231in"
height="0.9394116360454943in"}

Start FakeNet; this will create a fake network to trick the malware and
document calls

![A screenshot of a computer Description automatically generated with
medium confidence](./media/image4.png){width="4.063737970253718in"
height="3.4703412073490814in"}

Run RegShot, update the scan to \"C:\\\" and set the output path. Click
on 1^st^ shot to capture the first snap, this process will take a few
minutes

![Graphical user interface, application Description automatically
generated](./media/image5.png){width="2.635087489063867in"
height="2.6246719160104988in"}

Start the ProcMon capture

![Graphical user interface, text Description automatically
generated](./media/image6.png){width="4.065080927384077in"
height="2.5387871828521433in"}

Execute the Malware and leave it running for 5 minutes. You will start
to see traffic in FakeNet, ProcMon and other signs on the system, like
popups etc.

![Graphical user interface, text Description automatically
generated](./media/image7.png){width="2.6871642607174104in"
height="0.9686286089238845in"}

Stop the ProcMon capture

![Graphical user interface, text, application Description automatically
generated](./media/image3.png){width="3.740242782152231in"
height="0.9394116360454943in"}

Using RegShot capture, the 2^nd^ capture

![Graphical user interface, application Description automatically
generated](./media/image8.png){width="2.545094050743657in"
height="1.9975142169728783in"}

### Stage 3: Review the results

In RegShot, select compare and show output

![Graphical user interface, application Description automatically
generated](./media/image9.png){width="2.6965015310586176in"
height="1.912463910761155in"}

In the output, you will notice a registry written in this example
showing a persistence registry key.

![Text Description automatically generated with low
confidence](./media/image10.png){width="6.268055555555556in"
height="1.7861111111111112in"}

This also matches the registry key found in the user\'s hive.

![Graphical user interface, text, application Description automatically
generated](./media/image11.png){width="6.268055555555556in"
height="1.7722222222222221in"}

In ProcMon, perform a filtered view and review the results

Add the following filters:

-   ProcessNameis: malware-name

-   Operation is:

    -   WriteFile

    -   SetDispositionInformationFile

    -   RegSetValue

    -   ProcessCreate

![Graphical user interface Description automatically
generated](./media/image12.png){width="3.1280063429571303in"
height="1.8716754155730533in"}

Save the output for ProcMon and RegShot

Open the PCAP file created in FakeNet using WireShark to view any HTTP
or network requests

![Graphical user interface, text, application Description automatically
generated](./media/image13.png){width="6.268055555555556in"
height="3.707638888888889in"}

In this case, no network traffic was recorded.

### Stage 4: Resetting VM

Once the review has been completed. The VM will need to be reset. In
Hyper-V right, click on the VM and select revert to reset the VM.

![Graphical user interface, application, Word Description automatically
generated](./media/image14.png){width="2.4163648293963256in"
height="3.3329166666666667in"}
